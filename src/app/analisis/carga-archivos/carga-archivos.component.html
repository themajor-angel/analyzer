
<br>
<br>
<br>
<div fxLayout="column" fxLayoutAlign="center center" class="encabezado">
      <label for="input-file-id" class="md-button md-raised md-primary"
          >Seleccione una de sus empresas:
      </label>
      <div class="contenedor">
  <div class="contenedor_formulario">
        <mat-select placeholder="Empresa" name="empresa" (change)="onChance($event)">
        <mat-option *ngFor="let item of EsEmpresa" [value]="item">
          {{ item.nombreEmpresa }}
        </mat-option>
      </mat-select>
      </div>
</div>
      
</div>

<div fxLayout="column" fxLayoutAlign="center center" class="encabezado">
  <h1>
    Seleccione dos reportes de periodos correspondientes para comparar
  </h1>
</div>

<div class="pasoapaso">
  <mat-stepper [linear]="true" #stepper color="success">
    <mat-step
      [stepControl]="firstFormGroup"
      completed="{{ completo1 }}"
      label="Cargar archivo m치s reciente"
    >
    <!--(ngSubmit)="subirArchivo()"
       (change)="cambioArchivo($event);
    (click)="subirArchivo()"-->
      <form
        fxLayout="column"
        fxLayoutAlign="center center"
        fxLayoutGap="10px"
        #f="ngForm"
        [formGroup]="archivoForm"
        (ngSubmit)="onSubmit(f, stepper)"
        
      >
        <label for="input-file-id" class="md-button md-raised md-primary"
          >Seleccione el archivo del periodo m치s reciente</label
        >
        <input
          
          type="file"
          class="file-input"
          appReadexcel
          #readexcel="readexcel"
          (eventEmitter)="DataFromEventEmitter($event)"
          required
          formControlName="archivo" (change)="fileUploaded(true, false)"
        />
        <hr>
       <!--<progress *ngIf="porcentaje > 0 && porcentaje < 100" class="progress is-large is-success" value="{{porcentaje}}" max="100">{{porcentaje}}%</progress>
       <button [ngClass]="{'button': true, 'is-success': true, 'is-large': true, 'is-loading': porcentaje > 0 && porcentaje < 100}" [disabled]="!archivoForm.valid && (porcentaje > 0 && porcentaje < 100)">Subir archivo</button>-->
      <!--<progress class="progress is-large is-success" value="0" max="100">0%</progress>-->
        <button
          mat-raised-button
          color="primary"
          matStepperNext
          (click)="onSubmit(f, stepper)"
          [disabled]="!fileIsUploaded1"
        >
          Subir-Siguiente
        </button>
        
        <mat-spinner *ngIf="isLoading$ | async"></mat-spinner>
      </form>
    </mat-step>
    <mat-step
      [stepControl]="secondFormGroup"
      completed="{{ completo2 }}"
      label="Cargar archivo m치s antiguo"
    >
      <form
        fxLayout="column"
        fxLayoutAlign="center center"
        fxLayoutGap="10px"
        #form2="ngForm"
        (ngSubmit)="onSubmitComparacion(form2, stepper)"
        (change)="fileUploaded(true, true)"
          required
      >
        <label for="input-file-id" class="md-button md-raised md-primary"
          >Seleccione el archivo del periodo m치s antiguo</label
        >
        <input
          id="excel-1"
          type="file"
          class="file-input"
          appComparativeexcel
          #comparativeexcel="comparativeexcel"
          (eventEmitter)="DataFromEventEmitter($event)"
        />
        <hr>
      <!--<progress class="progress is-large is-success" value="0" max="100">0%</progress>-->
        <button
          mat-raised-button
          color="primary"
          matStepperNext
          (click)="onSubmitComparacion(form2, stepper)"
          [disabled]="!fileIsUploaded2"
        >
          Subir-Analizar
        </button>
        <mat-spinner *ngIf="isLoading$ | async"></mat-spinner>
      </form>
    </mat-step>
    <mat-step >
      <ng-template matStepLabel>Analizar archivos</ng-template>
      <div>
        <button
        *ngIf="!(isLoading$ | async)"
        type="submit"
        mat-raised-button
        color="primary"
        [disabled]="f.invalid"
        (click)="submit()"
      >
        Analizar
      </button>
      </div>
    </mat-step>
  </mat-stepper>

</div>

